<!DOCTYPE html>
<html lang="en">
<head>
    <title>Sports Score Interface</title>
    <%- include('partlies/head') %>

</head>
<body>

    <div class="container mt-4">
        <!-- Header -->
        <%- include('partlies/header') %>

        <!-- Main Content -->
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-3 sidebar">
                <div class="myLeague">
                    <h5 class="fw-bold">My League</h5>
                </div>
                <a href="#">
                    <div class="league-item active">
                        <img src="/img/orange-f.jpeg" alt="League" width="30" class="me-2">
                        <h4>Orange First Division</h4> 
                    </div>
                </a>

                <a href="#">
                    <div class="league-item">
                        <img src="/img/orange-s.jpeg" alt="League" width="30" class="me-2">
                        <h4>Orange Second Division</h4> 
                    </div>
                </a>

                <a href="#">
                    <div class="league-item">
                        <img src="/img/orange-w.png" alt="League" width="30" class="me-2">
                        <h4>Orange Women Division</h4> 
                    </div>
                </a>

                <a href="#">
                    <div class="league-item">
                        <img src="/img/meet.jpg" alt="League" width="30" class="me-2">
                        <h4>National County Meet</h4>
                    </div>
                 </a>
            </div>

            <!-- Main Scoreboard -->

             <!-- Main Scoreboard  navbar-->
            <div class="col-md-9">
                <div class="background">
                    <div class="main-navbtn d-flex bg-light justify-content-between">
                      <a href="/">  <button class="btn btn-hover">All Games</button></a>
                        <button class="btn btn-hover">Live Games</button>
                        <a href="fixture"><button class="btn btn-hover">Matches</button></a>
                        <button class="btn btn-hover">Table</button>
                    </div>
                </div>

              <!-- Live Games Section -->
                <div class="league-list">
                    <% matches.forEach(match => { %>
                        <div class="division-img">
                            <img src="/public/img/orange-f.jpeg" alt="">
                            <div class="league-title"><%= match.league_name %></div>
                        </div>
                        <div class="match-item" id="match-<%= match.match_id %>">
                            <div class="match-time">
                                <span
                                    id="time-<%= match.match_id %>" 
                                    data-start-time="<%= match.start_time %>" 
                                    data-status="<%= match.status %>">
                                    <%= match.status === 'ongoing' ? "0'" : "Scheduled" %>
                                </span>
                            </div>
                            <div class="teams">
                                <div class="team">
                                    <img src="<%= match.home_team_logo %>" alt="">
                                    <span><%= match.home_team_name %></span>
                                </div>
                                <div class="team">
                                    <img src="<%= match.away_team_logo %>" alt="">
                                    <span><%= match.away_team_name %></span>
                                </div>
                            </div>
                            <div class="scores">
                                <span id="home-score-<%= match.match_id %>"><%= match.home_score || 0 %></span> <br>
                                <span id="away-score-<%= match.match_id %>"><%= match.away_score || 0 %></span>
                            </div>
                        </div>
                    <% }) %>
                </div>
        
            </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
    <!-- <script src="/socket.io/socket.io.js"></script> -->
<script>
  const socket = io();

// Handle updates from the server
socket.on('statusChange', (data) => {
    const matchElement = document.getElementById(`match-${data.match_id}`);
    if (data.status === 'ongoing') {
        const timeElement = document.getElementById(`time-${data.match_id}`);
        timeElement.textContent = "0'";
    } else if (data.status === 'completed') {
        matchElement.remove();
    }
});

socket.on('scoreUpdate', (data) => {
    document.getElementById(`home-score-${data.match_id}`).textContent = data.home_score;
    document.getElementById(`away-score-${data.match_id}`).textContent = data.away_score;
});
</script>
</body>
</html>
